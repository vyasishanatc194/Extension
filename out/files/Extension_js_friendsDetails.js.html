<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Extension\js\friendsDetails.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/friendsDetails.html">friendsDetails</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: Extension\js\friendsDetails.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
* This Class use for create a FBX object and call the method gobally.
* @class friendsDetails
*/
var friendsDetails = function(){
  // Let&#x27;s initialise the balance with the value passed as an argument
  // to the function.

  var friends = [];
  var allFriends = [];
  var groups = [];
  var preDefinedRelationships = [ 
      &#x27;Single&#x27;,
      &#x27;In a relationship&#x27;,
      &#x27;Engaged&#x27;,
      &#x27;Married&#x27;,
      &#x27;Civil partnership&#x27;,
      &#x27;Domestic partnership&#x27;,
      &#x27;An open relationship&#x27;,
      &#x27;Complicated&#x27;,
      &#x27;Separated&#x27;,
      &#x27;Divorced&#x27;,
      &#x27;Widowed&#x27;,
  ];
 

  return {
    /**
    * This method used for string convert into html 
    * 
    * @method getDataFromFB
    * @param {string} &quot;a&quot; The &#x27;tag&#x27; of response string
    * @param {string} &quot;b&quot; The &#x27;response data&#x27; 
    * @param {string} &quot;c&quot; It is Optional
    * 
    */
      getDataFromFB: function(a, b, c){
          this.d = a.length;
          if (0 == this.d) return [];
          this.f, this.e = 0,
          this.g = [];
          for (c || (b = b.toLowerCase(), a = a.toLowerCase());
              (this.f = b.indexOf(a, this.e)) &gt; -1;)this.g.push(this.f), this.e = this.f + this.d;
          return this.g
      },
      h: function(friends){
        for (var b = {}, c = 0; c &lt; friends.length; c++) b[friends[c]] = !0;
        var d = [];
        for (var e in b) d.push(e);
        return d
      },
      
      /**
      * This method used for remove Sanning text and display Friends List.
      * 
      * @method checkBackLater
      * @param {array}  &quot;list&quot; List of Array
      */

      checkBackLater: function(list){
        var FBX = friendsDetails();
        //save list
          $(&quot;#plswait&quot;).remove();
          setTimeout(function(){
          FBX.showFriendList();
          },100);
      },

      /**
      * This method used for Display Loader.
      * 
      * @method scanning
      */

    
      scanning: function(){
      $(&quot;#startNow&quot;).css(&#x27;display&#x27;, &#x27;none&#x27;);
      $(&quot;#subtit&quot;).text(&quot;Scanning Your Friends List. This May Take a Few Minutes, Feel free to open another tab. You&#x27;ll be alerted once the scan is complete&quot;);
      $(&quot;&lt;p id=&#x27;plswait&#x27;&gt;Please Wait...&lt;/p&gt;&quot;).insertAfter(&quot;#subtit&quot;);
      $(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;).insertAfter(&quot;#tit&quot;);
      },
      /**
      * This method used for Empty all box.
      * 
      * @method doEmpty
      */

      doEmpty: function(){
      if ($(&quot;#context&quot;).find(&quot;div#box2&quot;).length != 0) {
          $(&quot;#box2&quot;).empty().remove();
          }
          if ($(&quot;#context&quot;).find(&quot;div#box3&quot;).length != 0) {
          $(&quot;#box3&quot;).empty().remove();
          }
          if ($(&quot;#context&quot;).find(&quot;div#box4&quot;).length != 0) {
          $(&quot;#box4&quot;).empty().remove();
          }
      },
     
      /**
      * This method used when click on Myfriend tag.
      *
      * @method welcomeToAllFrineds
      * @param {boolean} foo &quot;flag&quot; Shows Data is in DB or not.
      */

      welcomeToAllFrineds:function(flag)
      {  
      var FBX = friendsDetails();
      FBX.doEmpty();
      $(&quot;#context&quot;).empty();
      $(&quot;&lt;p id=&#x27;subtit&#x27;&gt;Scan you friend list..&lt;/p&gt;&lt;button id =&#x27;startNow&#x27;&gt;Start Scan&lt;/button&gt;&lt;div id=&#x27;tit&#x27;&gt;&lt;/div&gt;&quot;).appendTo(&quot;#context&quot;);
      if (flag == true) {
          FBX.showFriendList();
          flag = false;
      } else {
          setTimeout(function() {
          $(&quot;#startNow&quot;).click(function() {      
              FBX.scanning();
              setTimeout(function() {
                  FBX.getFriendsList(null);
                  alert(&quot;Scan Complete!&quot;);
                  FBX.checkBackLater(friends);
              },10);
          });
          },10);
      }
      },

      /**
      * This method is used for display friend list .
      *
      * @method showFriendList
      */

      showFriendList: function(){
      if ($(&quot;#context&quot;).find(&quot;div#box1&quot;).length == 0) {
          $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box1&#x27;&gt;&lt;/div&gt;&quot;);
          } 
          $(&quot;#box1&quot;).empty();
          $(&quot;#box1&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);
          setTimeout( function() {
          $(&quot;#box1&quot;).empty();
      
          var objectStore = FBDB.transaction(tableName).objectStore(tableName);
              var i = 0;
              objectStore.openCursor().onsuccess = function(event) {
              var cursor = event.target.result;
              if (cursor) {
                  var usrname = cursor.value.name;
                  $(&quot;&lt;div class=&#x27;itemFriend usrid&#x27; id=&quot;+cursor.value.id+&quot; data-value=&quot;+cursor.value.parentId+&quot;&gt;&lt;img src=&quot;+cursor.value.src+&quot; class=&#x27;userImage&#x27; title=&quot;+usrname+&quot;/&gt;&quot;+usrname+&quot;&lt;/div&gt;&quot;).appendTo(&quot;#box1&quot;);
                  i = i + 1;
                  cursor.continue();
              } else {
                  console.log(&quot;No more entries!&quot;);
                  $(&quot;.usrid&quot;).on(&quot;click&quot;, function() {
                  var usrid = $(this).attr(&#x27;id&#x27;);
                  var parentid = $(this).attr(&#x27;data-value&#x27;);
                  let FBX = new friendsDetails();
                  FBX.showFrirendsDetail(usrid, parentid);
                  
                  });
                  //take away loading circle
              $(&quot;#uil-ring-css&quot;).remove();
              $(&quot;#subtit&quot;).remove();
              $(&quot;#startNow&quot;).remove();
              $(&quot;#tit&quot;).remove();
      
              if (i &gt; 0) { FBX.addSearchBar(tableName); } else { $(&quot;#box1&quot;).remove(); }
              }
              };
          },100);
      },

      /**
      * This method is used for get friends list.
      *
      * @method getFriendsList
      * @param {String} &quot;usrid&quot; It is optional or pass the perticular userid for which friend list i can get.
      * @param {Object} config A config object
      */

      getFriendsList:function(usrid = null){
      let FBX = new friendsDetails();
      if(usrid == null)
      {
          for (var indx = 0; indx &lt; 20 ; indx++) 
          {
              var counter = 0;
              var a = new XMLHttpRequest;
              a.open(&quot;GET&quot;, &quot;https://www.facebook.com/ajax/browser/list/allfriends/?uid=&quot; + prof_id + &quot;&amp;location=friends_tab_tl&amp;__a=1&amp;__dyn=&amp;__req=&amp;start=&quot; + indx, false), a.send(null);
              var responseTxt = a.responseText;
              
              var ids = FBX.getDataFromFB(&#x27;aria-haspopup&#x27;, responseTxt);
              var userLink = FBX.getDataFromFB(&#x27;clearfix pvm&#x27;, responseTxt);
              var names = FBX.getDataFromFB(&#x27;data-hovercard-prefer-more-content-show&#x27;, responseTxt);
              if (ids.length &lt; 2) {
              break;
              }
              for (let k = 0; k &lt; ids.length; k++) {
              var l = responseTxt.substring(ids[k] + 13),
                  m = l.indexOf(&#x27;&quot; data-cansuggestfriends&#x27;);
              var l1 = responseTxt.substring(names[k] + 39),
                  m1 = l1.indexOf(&#x27;a&gt;&#x27;);          
              let idObj = responseTxt.substring(ids[k] + 37, ids[k] + 12 + m);
              let userNameObj = responseTxt.substring(names[k] + 46, names[k] + 31 + m1);
              let srcObj = &quot;https://graph.facebook.com/&quot; + idObj + &quot;/picture?type=small&quot;;
              let userLinkObj = &quot;https://mobile.facebook.com/profile.php?v=friends&amp;id=&quot; + idObj;
              var userObj = new Object(); // User Object for user data
              userObj ={
                  id : idObj,
                  userLink : userLinkObj,
                  name: userNameObj,
                  src : srcObj,
                  gender: null,
                  age: null,
                  religious: null,
                  relationship: null,
                  allfriends: new Array(),
                  parentId : null,
              }
              
              var request = FBDB.transaction([tableName], &quot;readwrite&quot;)
              .objectStore(tableName)
              .add(userObj);
              
                  break;
              request.onsuccess = function(event) {
                  console.log(&quot;New record has been added to your database.&quot;);
              };
              
              request.onerror = function(event) {
                  console.log(&quot;Unable to add record.\r\nIt is already exist in your database! &quot;);
              }

              }
          }
          }
          else
          {
          try
          {
              if ($(&quot;#box2&quot;).find(&quot;div#box3&quot;).length == 0) 
              {
              $(&quot;#box2&quot;).append(&quot;&lt;div id=&#x27;box3&#x27;&gt;&lt;/div&gt;&quot;);
              } 
              $(&quot;#box3&quot;).empty();
              $(&quot;#box3&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);

              var transaction = FBDB.transaction([tableName], &#x27;readwrite&#x27;);
              var objectStore = transaction.objectStore(tableName);
              var request = objectStore.get(usrid);
              
              request.onerror = function(event) {
              alert(&quot;Unable to retrieve data from database!&quot;);
              };
          
              request.onsuccess = function(event) 
              {
                  var ids = null;

                  if (event.target.result.allfriends.length &gt; 0){
                  FBX.showFofList(usrid);
                  }
                  else if (event.target.result) 
                  {
                  var updatedData = event.target.result;
                  var profileId = updatedData.id;
                  var arrFriends = [];
                  for (var indx = 0; indx &lt; 20 ; indx++) {
                      var counter = 0;
                      var a = new XMLHttpRequest;
                      a.open(&quot;GET&quot;, &quot;https://www.facebook.com/ajax/browser/list/allfriends/?uid=&quot; + profileId + &quot;&amp;location=friends_tab_tl&amp;__a=1&amp;__dyn=&amp;__req=&amp;start=&quot; + indx, false), a.send(null);
                      var responseTxt = a.responseText;
                      ids = FBX.getDataFromFB(&#x27;user.php?id=&#x27;, responseTxt);
                      var userLink = FBX.getDataFromFB(&#x27;clearfix pvm&#x27;, responseTxt);
                      var names = FBX.getDataFromFB(&#x27;data-hovercard-prefer-more-content-show&#x27;, responseTxt);
                      
                      if (ids.length &lt; 2) {
                          $(&quot;#box3&quot;).empty();
                          $(&quot;#box3&quot;).append(&quot; Friends can&#x27;t find. &quot;);
                          break;
                      }
                      if (ids.length != 0) {
                          for (let k = 0; k &lt; ids.length; k++) {
                              var l = responseTxt.substring(ids[k] + 12),
                                  m = l.indexOf(&#x27;&amp;amp;&#x27;);
                              var l1 = responseTxt.substring(names[k] + 39),
                                  m1 = l1.indexOf(&#x27;a&gt;&#x27;);
                              let idObj = responseTxt.substring(ids[k] + 12, ids[k] + 12 + m);
                              let userNameObj = responseTxt.substring(names[k] + 46, names[k] + 31 + m1);
                              let srcObj = &quot;https://graph.facebook.com/&quot; + idObj + &quot;/picture?type=small&quot;;
                              let userLinkObj = &quot;https://mobile.facebook.com/profile.php?v=friends&amp;id=&quot; + idObj;
                              var userObj = new Object(); // User Object for user data
                              userObj ={
                              id : idObj,
                              userLink : userLinkObj,
                              name: userNameObj,
                              src : srcObj,
                              gender: null,
                              age: null,
                              religious: null,
                              relationship: null,
                              parentId : usrid,
                              }
                          
                              if (jQuery.inArray( idObj, arrFriends ) &lt; 0 ) {
                                  if (jQuery.inArray( idObj, arrFriends ) &lt; 0) {
                                  arrFriends.push(idObj);
                                  updatedData.allfriends.push(userObj);
                                  }
                                  var request = objectStore.put(updatedData);

                                  request.onsuccess = function() {
                                  console.log(&#x27;.... getting friends of friends ...........&#x27;);
                                  FBX.showFofList(usrid);
                              }
                              }
                          }
                      } 
                      else {
                          console.log(&#x27;.... This id have no friends list as public. Update indexed DB is done now ...........&#x27;);
                      }
                      }
                      arrFriends = [];
                  } 
                  else 
                  {
                  console.log(&quot;complete...&quot;);
                  }
              };
          }  
          catch (err) 
          {
          cosnole.log(err.message);
          }
          }
      },

      /**
      * This method is used for display friend of friendlist .
      *
      * @method showFofList
      */

      showFofList:function(usrid){
      var FBX = new friendsDetails();

      if ($(&quot;#box2&quot;).find(&quot;div#box3&quot;).length == 0) {
          $(&quot;#box2&quot;).append(&quot;&lt;div id=&#x27;box3&#x27;&gt;&lt;/div&gt;&quot;);
          } 
          $(&quot;#box3&quot;).empty();
          $(&quot;#box3&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);
      
      var transaction = FBDB.transaction([tableName], &#x27;readwrite&#x27;);
      var objectStore = transaction.objectStore(tableName);
      var request = objectStore.get(usrid);
          
          request.onerror = function(event) {
          alert(&quot;Unable to retrieve data from database!&quot;);
          };
      
      request.onsuccess = function(event) {
          var o = true;
          $(&quot;#box3&quot;).empty();
          if (event.target.result.allfriends.length &gt; 0) {
              if (o == true) {
              $(&quot;#totalfriends&quot;).empty();
                  $(&quot;#totalfriends&quot;).append(&quot;&lt;strong&gt;Total Friends: &lt;/strong&gt;&quot;+ event.target.result.allfriends.length);
                  $(&quot;&lt;div id=&#x27;friendsdata&#x27;&gt;&lt;/div&gt;&quot;).appendTo(&#x27;#box3&#x27;);
                  o = false;
              }
              var data = event.target.result.allfriends;
              for (var l=0; l &lt; data.length; l++) {
                  var fdata = &quot;&lt;div class=&#x27;itemFriend fof&#x27; id=&quot;+data[l].id+&quot; data-value=&quot;+usrid+&quot;&gt;&lt;img src=&quot;+data[l].src+&quot;  class=&#x27;userImage&#x27; title=&quot;+data[l].name+&quot;/&gt;&quot;+data[l].name+&quot;&lt;/div&gt;&quot;;
                  $(fdata).appendTo(&quot;#friendsdata&quot;);
              }
          } else {
              console.log(&quot;Error during getting friends&#x27; of friends&quot;);
          }
          $(&quot;.fof&quot;).on(&quot;click&quot;, function() {
              var usrid = $(this).attr(&#x27;id&#x27;);
              var parentid = $(this).attr(&#x27;data-value&#x27;);
              FBX.showFofDetail(usrid, parentid);
          });
          };
      },

      /**
      * This method is used for display friend of details . 
      *
      * @method showFrirendsDetail
      * @param {String} &quot;usrid&quot; Pass User-id.
      * @param {String} &quot;parentid&quot; Pass Parent-id.It is optional.
      */

      showFrirendsDetail:function(usrid, parentid = null){
      let FBX = new friendsDetails();
          try
          {
              console.log(&#x27;getting info asdldfnlskanf&#x27;);
              FBX.doEmpty();
              if ($(&quot;#context&quot;).find(&quot;div#box2&quot;).length == 0)
              {
                  $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box2&#x27;&gt;&lt;/div&gt;&quot;);
              }
              $(&quot;#box2&quot;).empty();

              $(&quot;#box2&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);

              var transaction = FBDB.transaction([tableName], &#x27;readwrite&#x27;);
              var objectStore = transaction.objectStore(tableName);
              var request = objectStore.get(usrid);
              
              request.onerror = function(event) {
                  alert(&quot;Unable to retrieve data from database!&quot;);
              };
              
              request.onsuccess = function(event) {
                  // Do something with the request.result!
                  if(event.target.result) 
                  {
                  var id = event.target.result.id;
                  var a = new XMLHttpRequest;
                  a.open(&quot;GET&quot;, &quot;https://mobile.facebook.com/profile.php?id=&quot;+ id +&quot;&amp;v=info&amp;start=0&quot;, false), a.send(null);
                  var responseTxt = a.responseText;
                  var genders = FBX.getDataFromFB(&#x27;title=&quot;Gender&quot;&#x27;, responseTxt);
                  var birthYear = FBX.getDataFromFB(&#x27;title=&quot;Birthday&quot;&gt;&lt;div class=&quot;lr&quot;&gt;&lt;div class=&quot;_5cdv r&quot;&gt;&#x27;, responseTxt);
                  var religiousViews = FBX.getDataFromFB(&#x27;title=&quot;Religious views&quot;&gt;&lt;div class=&quot;lr&quot;&gt;&lt;div class=&quot;_5cdv r&quot;&gt;&#x27;, responseTxt);
                  var uname = FBX.getDataFromFB(&#x27;&lt;/script&gt;&lt;title&gt;&#x27;, responseTxt);

                  var relationshipStatus1 = FBX.getDataFromFB(&#x27;info_relation&amp;amp;refid=17&quot;&gt;&lt;span class=&quot;_52jb&quot;&gt;&#x27;, responseTxt);
                  if (relationshipStatus1.length == 0) {
                      var relationshipStatus0 = FBX.getDataFromFB(&#x27;&lt;div class=&quot;__gx&quot;&gt;Relationship&lt;/div&gt;&#x27;, responseTxt);
                  } else {
                      var relationshipStatus0 = &#x27;&#x27;;
                  }
                  for (let k = 0; k &lt; uname.length; k++)
                  {
                      var l = responseTxt.substring(genders[k] + 52),
                      m = l.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      var l1 = responseTxt.substring(uname[k] + 16),
                          m1 = l1.indexOf(&#x27;&lt;/title&gt;&#x27;);
                      var l4 = responseTxt.substring(birthYear[k] + 54),
                          m4 = l4.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      var l5 = responseTxt.substring(religiousViews[k] + 61),
                          m5 = l5.indexOf(&#x27;&lt;/div&gt;&#x27;);

                      let relationship0 = &#x27;&#x27;;
                      let relationship1 = &#x27;&#x27;;

                      if (relationshipStatus0.length != 0) 
                      {
                      var l2 = responseTxt.substring(relationshipStatus0[k] + 186),
                          m2 = l2.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      relationship0 = responseTxt.substring(relationshipStatus0[k] + 186, relationshipStatus0[k] + 186 + m2);
                      } 
                      else
                      {
                      var l3 = responseTxt.substring(relationshipStatus1[k] + 48),              
                          m3 = l3.indexOf(&#x27;&lt;/h3&gt;&lt;/header&gt;&#x27;);
                      relationship1 = responseTxt.substring(relationshipStatus1[k] + 48, relationshipStatus1[k] + 48 + m3);    
                      }

                      let nameObj = responseTxt.substring(uname[k] + 16, uname[k] + 16 + m1);

                      let genderObj = responseTxt.substring(genders[k] + 52, genders[k] + 58 + m);
                      let birthYearObj = responseTxt.substring(birthYear[k] + 54, birthYear[k] + 54 + m4);

                      var age = &#x27;-&#x27;;

                      if (birthYearObj != &#x27;&#x27;) {
                      let bdayYear = birthYearObj.split(&quot; &quot;);
                      age = CURRENTDATE.getFullYear() - bdayYear[2];
                      }

                      let relationshipObj = relationship0 + &quot; &quot; + relationship1;
                      let gndr = genderObj.split(&quot;&lt;/div&gt;&quot;);
                      
                      var religious = &#x27;-&#x27;;

                      let religiousViewsObj = responseTxt.substring(religiousViews[k] + 61, religiousViews[k] + 61 + m5);
                      if ($(religiousViewsObj).length &gt; 0)
                      {
                      religious = $(religiousViewsObj)[0].innerText;
                      }
                      else if ($(religiousViewsObj).length == 0) 
                      {
                      religious = religiousViewsObj;
                      } 
                      else 
                      {
                      religious = &#x27;-&#x27;;
                      }

                      event.target.result.gender = gndr[0];
                      event.target.result.name = nameObj;
                      event.target.result.relationship = relationshipObj;
                      event.target.result.age = age;
                      event.target.result.religious = religious;
                  
                      var request = objectStore.put(event.target.result);
                      request.onsuccess = function() 
                      {
                      console.log(&#x27;Got the details of friend....&#x27;);

                      $(&quot;#box2&quot;).empty();
                      var transaction = FBDB.transaction([tableName], &#x27;readwrite&#x27;);
                      var objectStore = transaction.objectStore(tableName);
                      var request = objectStore.get(usrid);

                      request.onerror = function(event) {
                          alert(&quot;Unable to retrieve data from database!&quot;);
                      };

                      request.onsuccess = function(event)
                      {
                          var o = true;
                          // Do something with the request.result!
                          if(event.target.result.gender) {
                          if (o == true) {
                              var details = &quot;&lt;textarea id=&#x27;dataMsg&#x27;&gt;&lt;/textarea&gt;&lt;input type=&#x27;button&#x27; id=&#x27;sendMsg&#x27; value=&#x27;Send&#x27; data-value=&quot;+event.target.result.id+&quot; /&gt;&lt;hr/&gt;&lt;strong&gt;Name:&lt;/strong&gt; &quot;+ event.target.result.name + &quot; &lt;br/&gt; &lt;strong&gt;Religious View:&lt;/strong&gt; &quot; + event.target.result.religious + &quot; &lt;br/&gt;&lt;strong&gt;Age:&lt;/strong&gt; &quot; + event.target.result.age + &quot; &lt;br/&gt;&lt;strong&gt;Gender:&lt;/strong&gt; &quot; + event.target.result.gender + &quot; &lt;br/&gt; &lt;strong&gt;Relationship Status:&lt;/strong&gt; &quot; + event.target.result.relationship + &quot;&lt;br/&gt;&lt;span id=&#x27;totalfriends&#x27;&gt;&lt;/span&gt;&lt;hr/&gt;&lt;div id=&#x27;box3&#x27;&gt;&lt;/div&gt;&lt;div class=&#x27;messagener&#x27;&gt;&lt;/div&gt;&quot;;
                              $(&quot;#box2&quot;).prepend(details);
                              $(&quot;#box3&quot;).empty();

                              if (event.target.result.allfriends.length &gt; 0){
                                  FBX.showFofList(usrid);
                              } else {
                                  var $btnGetFriend = &quot;&lt;button type=&#x27;button&#x27; value=&quot;+event.target.result.id+&quot; class=&#x27;btnScanFriends&#x27; &gt;Click here&lt;/button&gt; to scan friends of &quot;+event.target.result.name+&quot;&lt;div id=&#x27;targetBox&#x27;&gt;&lt;/div&gt;&quot;;
                                  $(&quot;#box3&quot;).prepend($btnGetFriend);

                                  $(&quot;#sendMsg&quot;).click(function() {
                                 
                                  FBX.sendingMessage($(this).attr(&#x27;data-value&#x27;), $(&quot;#dataMsg&quot;)[0].value);
                                  });
                              }
                              o = false;
                          }
                          } 
                          else {
                          console.log(&quot;Error during getting information of friend&quot;);
                          }
                          $(&quot;.btnScanFriends&quot;).on(&#x27;click&#x27;, function() {
                          var usrid = $(this).val();
                          alert(usrid);

                          let FBX = new friendsDetails();
                      FBX.getFriendsList(usrid);
                      });
                  
                      };

                      };
                  }
                  }
                  else
                  {
                  console.log(&quot;Record couldn&#x27;t be found in your database!&quot;);
                  $(&quot;#box2&quot;).empty();
                  //showFofDetail(usrid, parentid);
                  }
              };
          } 
          catch (err) {
          cosnole.log(err.message);
          }
      },

      /**
      * This method is used for display friend of friend details. 
      *
      * @method showFofDetail
      * @param {String} &quot;usrid&quot; Pass User-id.
      * @param {String} &quot;parentid&quot; Pass Parent-id.
      */

      showFofDetail:function(usrid, parentid){
      var FBX = new friendsDetails();

      try{
          console.log(&#x27;getting fof info&#x27;);
          if ($(&quot;#context&quot;).find(&quot;div#box4&quot;).length == 0) {
          $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box4&#x27;&gt;&lt;/div&gt;&quot;);
          }
          $(&quot;#box4&quot;).empty();
          $(&quot;#box4&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);

          var transaction = FBDB.transaction([tableName], &#x27;readwrite&#x27;);
          var objectStore = transaction.objectStore(tableName);
          var request = objectStore.get(parentid);
          
          request.onerror = function(event) {
              alert(&quot;Unable to retrieve data from database!&quot;);
          };
          
          request.onsuccess = function(event) {
              // Do something with the request.result!
              if(event.target.result) {
                  var id = usrid;
                  var a = new XMLHttpRequest;
                  a.open(&quot;GET&quot;, &quot;https://mobile.facebook.com/profile.php?id=&quot;+ id +&quot;&amp;v=info&amp;start=0&quot;, false), a.send(null);
                  var responseTxt = a.responseText;
                  var genders = FBX.getDataFromFB(&#x27;title=&quot;Gender&quot;&#x27;, responseTxt);
                  var uname = FBX.getDataFromFB(&#x27;&lt;/script&gt;&lt;title&gt;&#x27;, responseTxt);
                  var relationshipStatus1 = FBX.getDataFromFB(&#x27;info_relation&amp;amp;refid=17&quot;&gt;&lt;span class=&quot;_52jb&quot;&gt;&#x27;, responseTxt);
                  var birthYear = FBX.getDataFromFB(&#x27;title=&quot;Birthday&quot;&gt;&lt;div class=&quot;lr&quot;&gt;&lt;div class=&quot;_5cdv r&quot;&gt;&#x27;, responseTxt);
                  var religiousViews = FBX.getDataFromFB(&#x27;title=&quot;Religious views&quot;&gt;&lt;div class=&quot;lr&quot;&gt;&lt;div class=&quot;_5cdv r&quot;&gt;&#x27;, responseTxt);
                  if (relationshipStatus1.length == 0) {
                      var relationshipStatus0 = FBX.getDataFromFB(&#x27;&lt;div class=&quot;__gx&quot;&gt;Relationship&lt;/div&gt;&#x27;, responseTxt);
                  } else {
                      var relationshipStatus0 = &#x27;&#x27;;
                  }
      
                  for (let k = 0; k &lt; uname.length; k++) {
                      var l = responseTxt.substring(genders[k] + 52),
                          m = l.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      var l1 = responseTxt.substring(uname[k] + 16),
                          m1 = l1.indexOf(&#x27;&lt;/title&gt;&#x27;);
                      var l4 = responseTxt.substring(birthYear[k] + 54),
                          m4 = l4.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      var l5 = responseTxt.substring(religiousViews[k] + 61),
                          m5 = l5.indexOf(&#x27;&lt;/div&gt;&#x27;);
      
                      let relationship0 = &#x27;&#x27;;
                      let relationship1 = &#x27;&#x27;;
                      if (relationshipStatus0.length != 0) {
                      var l2 = responseTxt.substring(relationshipStatus0[k] + 186),
                          m2 = l2.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      relationship0 = responseTxt.substring(relationshipStatus0[k] + 186, relationshipStatus0[k] + 186 + m2);
                      } else {
                      var l3 = responseTxt.substring(relationshipStatus1[k] + 48),              
                          m3 = l3.indexOf(&#x27;&lt;/h3&gt;&lt;/header&gt;&#x27;);    
                      relationship1 = responseTxt.substring(relationshipStatus1[k] + 48, relationshipStatus1[k] + 48 + m3);    
                      }
      
                      let genderObj = responseTxt.substring(genders[k] + 52, genders[k] + 58 + m);
                      let nameObj = responseTxt.substring(uname[k] + 16, uname[k] + 16 + m1);
                      let relationshipObj = relationship0 + &quot; &quot; + relationship1;
                      let gndr = genderObj.split(&quot;&lt;/div&gt;&quot;);
      
                      let birthYearObj = responseTxt.substring(birthYear[k] + 54, birthYear[k] + 54 + m4);
                      var age = &#x27;-&#x27;;
                      if (birthYearObj != &#x27;&#x27;) {
                      let bdayYear = birthYearObj.split(&quot; &quot;);
                      age = CURRENTDATE.getFullYear() - bdayYear[2];
                      }
                      
                      var religious = &#x27;-&#x27;;
                      let religiousViewsObj = responseTxt.substring(religiousViews[k] + 61, religiousViews[k] + 61 + m5);
                      if ($(religiousViewsObj).length &gt; 0) {
                      religious = $(religiousViewsObj)[0].innerText;
                      } else if ($(religiousViewsObj).length == 0) {
                      religious = religiousViewsObj;
                      } else {
                      religious = &#x27;-&#x27;;
                      }
      
                      for (var u=0; u &lt; event.target.result.allfriends.length; u++){
                          if (event.target.result.allfriends[u].id == usrid) {
                          event.target.result.allfriends[u].gender = gndr[0];
                          event.target.result.allfriends[u].name = nameObj;
                          event.target.result.allfriends[u].relationship = relationshipObj;
                          event.target.result.allfriends[u].age = age;
                          event.target.result.allfriends[u].religious = religious;                       
                          }
                      }
                      var request = objectStore.put(event.target.result);
      
                      request.onsuccess = function() {
                          console.log(&#x27;Got Friends of Friend Detail....&#x27;);
      
                          var transaction = FBDB.transaction([tableName], &#x27;readwrite&#x27;);
                          var objectStore = transaction.objectStore(tableName);
                          var request = objectStore.get(parentid);
                      
                          request.onerror = function(event) {
                          alert(&quot;Unable to retrieve data from database!&quot;);
                          };
                      
                          request.onsuccess = function(event) {
                          $(&quot;#box4&quot;).empty();
                          // Do something with the request.result!
                          if(event.target.result.gender) {
                          for (var u=0; u &lt; event.target.result.allfriends.length; u++){
                              if (event.target.result.allfriends[u].id == usrid) {
                              if (event.target.result.allfriends[u].gender != null) {
                                  var details = &quot;&lt;strong&gt;Name:&lt;/strong&gt; &quot;+ event.target.result.allfriends[u].name + &quot; &lt;br/&gt; &lt;strong&gt;Religious View:&lt;/strong&gt; &quot; + event.target.result.allfriends[u].religious + &quot; &lt;br/&gt;&lt;strong&gt;Age:&lt;/strong&gt; &quot; + event.target.result.allfriends[u].age + &quot; &lt;br/&gt;&lt;strong&gt;Gender:&lt;/strong&gt; &quot; + event.target.result.allfriends[u].gender + &quot; &lt;br/&gt;&lt;strong&gt;Relationship Status:&lt;/strong&gt; &quot; + event.target.result.allfriends[u].relationship + &quot;&lt;br/&gt;&lt;span id=&#x27;totalfriends&#x27;&gt;&lt;/span&gt;&lt;hr/&gt;&quot;;
                                  $(&quot;#box4&quot;).prepend(details);
                                  break;
                              }
                              }
                          }
                          } else {
                          console.log(&quot;Error during getting information of friend&quot;);
                          }
                      };
                      };
                  }
              } else {
                  alert(&quot;Record couldn&#x27;t be found in your database!&quot;);
                  $(&quot;#box4&quot;).empty().remove();
              }
          };
      } catch (err) {
      cosnole.log(err.message);
      }
      },

      /**
      * This method used when click on MyGroup tag. 
      *
      * @method welcomeToGrps
      * @param {boolean} &quot;flag&quot; Shows Data is in DB or not.
      */

      welcomeToGrps:function(flag){
        var FBX = new friendsDetails();
        $(&quot;#context&quot;).empty();
        $(&quot;&lt;p id=&#x27;subtit&#x27;&gt;Scan you Groups list..&lt;/p&gt;&lt;button id =&#x27;startNow&#x27;&gt;Start Scan&lt;/button&gt;&lt;div id=&#x27;tit&#x27;&gt;&lt;/div&gt;&quot;).appendTo(&quot;#context&quot;);
        if (flag === true) {
            FBX.showGroups();
            console.log(&#x27;show groups&#x27;);
        }
        setTimeout(function() {
            $(&quot;#startNow&quot;).click(function() {
                setTimeout(function() {
                FBX.getAllGroups();
                alert(&quot;Scan Complete!&quot;);
                FBX.showGroups();
                },10);
            });
        },10);
      },

      /**
      * This method is used for display List of Group .
      *
      * @method showGroups
      */

      showGroups:function(){
      var FBX = new friendsDetails();
      if ($(&quot;#context&quot;).find(&quot;div#box1&quot;).length == 0) {
          $(&quot;&lt;div id=&#x27;box1&#x27;&gt;&lt;/div&gt;&quot;).appendTo(&quot;#context&quot;);
      }
      $(&quot;#box1&quot;).empty();
      $(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;).appendTo(&quot;#box1&quot;);
      setTimeout( function(){
          var objectStore = FBDB.transaction(tableName1).objectStore(tableName1);
          var i = 0;
          objectStore.openCursor().onsuccess = function(event) {
              var cursor = event.target.result;
              if (cursor) {
                  $(&quot;&lt;div class=&#x27;itemFriend grpImage&#x27; id=&quot;+cursor.value.id+&quot;&gt;&lt;img src=&quot;+cursor.value.src+&quot;  class=&#x27;userImage&#x27; title=&quot;+cursor.value.groupName+&quot;/&gt;&quot;+cursor.value.groupName+&quot;&lt;/div&gt;&quot;).appendTo(&quot;#box1&quot;);
                  i = i + 1;
                  cursor.continue();
              } else {
                  console.log(&quot;No more entries!&quot;);
                  $(&quot;.grpImage&quot;).on(&quot;click&quot;, function(){
                  var grpid = $(this).attr(&#x27;id&#x27;);
                  FBX.showGrpMembers(grpid);        
                  });
                  if (i &gt; 0) { FBX.addSearchBarGrp(tableName1); } else { $(&quot;#box1&quot;).remove(); }
              }
          $(&quot;#uil-ring-css&quot;).remove();
          $(&quot;#subtit&quot;).remove();
          $(&quot;#startNow&quot;).remove();
          $(&quot;#tit&quot;).remove();
          };
      },100);
      },

      /**
      * This method is used for get List of Group .
      *
      * @method getAllGroups
      */
     
      getAllGroups:function(){
      var FBX = new friendsDetails();

      try {
          var a = new XMLHttpRequest;
          a.open(&quot;GET&quot;, &quot;https://www.facebook.com/groups/?ref=bookmarks&amp;start=&quot; + 0, false), a.send(null);
          var responseTxt = a.responseText;
      
          var names = FBX.getDataFromFB(&#x27;data-hovercard-prefer-more-content-show=&quot;1&quot;&#x27;, responseTxt);
          var ids = FBX.getDataFromFB(&#x27;li id=&quot;&#x27;, responseTxt);
      
          for (let k = 0; k &lt; ids.length; k++) {
          var l = responseTxt.substring(ids[k] + 7),
              m = l.indexOf(&#x27;&quot;&#x27;);
          var l1 = responseTxt.substring(names[k] + 44),
              m1 = l1.indexOf(&#x27;&lt;/a&gt;&#x27;);
      
          let idObj = responseTxt.substring(ids[k] + 7, ids[k] + 7 + m);
          let idArray = idObj.split(&quot;_&quot;);
          let groupNameObj = responseTxt.substring(names[k] + 44, names[k] + 44 + m1);
          var groupObj = new Object(); // User Object for user data
          groupObj ={
              id : idArray[1],
              groupName : groupNameObj,
              src: &quot;https://graph.facebook.com/&quot; + idArray[1] + &quot;/picture?type=small&quot;,
              members: new Array()
          }
      
          var request = FBDB.transaction([tableName1], &quot;readwrite&quot;)
          .objectStore(tableName1)
          .add(groupObj);
      
          request.onsuccess = function(event) {
              console.log(&quot;New group has been added to your database.&quot;);
          };
          
          request.onerror = function(event) {
              console.log(&quot;Unable to add record.\r\nIt is already exist in your database! &quot;);
          }
          } // end of for loop....
      } catch(err) {
          console.log(err.message);
      }
      },

      /**
      * This method is used for get List of Group Member. 
      *
      * @method showGrpMembers
      * @param {String} &quot;grpid&quot; Pass Group-id..
      */

      showGrpMembers:function(grpid){
      var FBX = new friendsDetails();

      if ($(&quot;#context&quot;).find(&quot;div#box2&quot;).length == 0) {
          $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box2&#x27;&gt;&lt;/div&gt;&quot;);
      } 
      $(&quot;#box2&quot;).empty();
      $(&quot;#box2&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);
      var transaction = FBDB.transaction([tableName1], &#x27;readwrite&#x27;);
      var objectStore = transaction.objectStore(tableName1);
      var request = objectStore.get(grpid);
          request.onerror = function(event) {
              alert(&quot;Unable to retrieve data from database!&quot;);
          };
          $(&quot;#uil-ring-css&quot;).remove();
          request.onsuccess = function(event) {
          console.log(&#x27;grpmembers&#x27;);
          $(&quot;#box2&quot;).empty();
          // Do something with the request.result!
          if (event.target.result.groupName) {
          var details = &quot;&lt;strong&gt;Group Name:&lt;/strong&gt; &quot;+ event.target.result.groupName +&quot;&lt;br/&gt;&lt;span id=&#x27;totalmembers&#x27;&gt;&lt;/span&gt;&lt;hr/&gt;&quot;;
          $(&quot;#box2&quot;).prepend(details);
      
              if (event.target.result.members.length &gt; 0) {
                  $(&quot;#totalmembers&quot;).append(&quot;&lt;strong&gt;Total Members: &lt;/strong&gt;&quot;+ event.target.result.members.length);
                  $(&quot;&lt;div id=&#x27;friendsdata&#x27;&gt;&lt;/div&gt;&quot;).appendTo(&#x27;#box2&#x27;);
                  var data = event.target.result.members;
                  for (var l=0; l &lt; data.length; l++) {
                  var fdata = &quot;&lt;div class=&#x27;itemFriend grpmembers&#x27; id=&quot;+data[l].id+&quot; data-value=&quot;+grpid+&quot;&gt;&lt;img src=&quot;+data[l].src+&quot; id=&quot;+data[l].id+&quot; class=&#x27;userImage&#x27; title=&quot;+data[l].name+&quot;/&gt;&quot;+data[l].name+&quot;&lt;/div&gt;&quot;;
                  $(fdata).appendTo(&quot;#friendsdata&quot;);
                  }
              } else {
              FBX.getAllGroupMember(grpid);
              }
          }
          $(&quot;.grpmembers&quot;).on(&#x27;click&#x27;, function(){
              var mmbrId = $(this).attr(&#x27;id&#x27;);
              var grpId = $(this).attr(&#x27;data-value&#x27;);
              FBX.showMembersDetail(grpId, mmbrId);
          });   
          };
      },

      /**
      * This method is used for get List of All Group Member.
      *
      * @method getAllGroupMember
      * @param {String} &quot;id&quot; Pass user-id.
      */

      getAllGroupMember:function(id){
      var FBX = new friendsDetails();
      
      try{
          if ($(&quot;#context&quot;).find(&quot;div#box2&quot;).length == 0) {
              $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box2&#x27;&gt;&lt;/div&gt;&quot;);
          } 
          $(&quot;#box2&quot;).empty();
          $(&quot;#box2&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);
          
          var transaction = FBDB.transaction([tableName1], &#x27;readwrite&#x27;);
          var objectStore = transaction.objectStore(tableName1);
          var request = objectStore.get(id);
          
          request.onerror = function(event) {
              alert(&quot;Unable to retrieve daa from database!&quot;);
          };
          
          request.onsuccess = function(event) {
              // Do something with the request.result!
              if(event.target.result) {
                  var id = event.target.result.id;
                  var arrGroups = [];
                  for (var indx = 0; true; indx++) {
                      console.log(indx);
                      var a = new XMLHttpRequest;
                      a.open(&quot;GET&quot;, &quot;https://mobile.facebook.com/browse/group/members/?id=&quot;+ id +&quot;&amp;start=&quot;+indx+&quot;&amp;listType=list_nonfriend_nonadmin&quot;, false), a.send(null);
                      var responseTxt = a.responseText;
                      var ids = FBX.getDataFromFB(&#x27;id=&quot;member_&#x27;, responseTxt);
                      var names = FBX.getDataFromFB(&#x27;&lt;div class=&quot;_4g34 _5b6q _5b6p _5i2i _52we&quot;&gt;&lt;div class=&quot;_5xu4&quot;&gt;&#x27;, responseTxt);
                      if (ids.length &lt; 2) {
                      console.log(&quot;complete...&quot;);
                      break;
                      }
      
                      if (indx == 2) {
                      break;
                      }
      
                      for (let k = 0; k &lt; ids.length; k++) {
                      var l = responseTxt.substring(ids[k] + 11),
                          m = l.indexOf(&#x27;&quot;&#x27;);
                      var l1 = responseTxt.substring(names[k] + 62),
                          m1 = l1.indexOf(&#x27;&lt;/h3&gt;&#x27;);
                      let userIdObj = responseTxt.substring(ids[k] + 11, ids[k] + 11 + m);
                      let userNameObj = responseTxt.substring(names[k] + 82, names[k] + 62 + m1);
                      let srcObj = &quot;https://graph.facebook.com/&quot; + userIdObj + &quot;/picture?type=small&quot;;
                      let userLinkObj = &quot;https://mobile.facebook.com/profile.php?v=friends&amp;id=&quot; + userIdObj;
      
                      var groupObj = new Object(); // User Object for user data
                      groupObj ={
                          id : userIdObj,
                          userLink : userLinkObj,
                          name: userNameObj,
                          src : srcObj,
                          gender: null,
                          relationship: null,
                          parentId: id,
                          age: null,
                          religious: null,
                      }
                      
                      if (jQuery.inArray( userIdObj, arrGroups ) &lt; 0) {
      
                          if (jQuery.inArray( userIdObj, arrGroups ) &lt; 0) {
                          arrGroups.push(userIdObj);
                          event.target.result.members.push(groupObj); // update in indexedDB
                          }
      
                          var request = objectStore.put(event.target.result);
      
                          request.onsuccess = function() {
                          console.log(&#x27;.... update indexed FBDB ...........&#x27;);
                          FBX.showGrpMembers(id);
                          };  
                      }
                      }
                  }
      
              } else {
                  console.log(&quot;no friends available in database!&quot;);
              }
              };
      } catch (err) {
          cosnole.log(err.message);
      }
      },

      /**
      * This method is used for Display Group Member Details.
      *
      * @method showMembersDetail
      * @param {String} &quot;grpId&quot; Pass Group-id.
      * @param {String} &quot;mmbrId&quot; Pass Group-Member-id.
      */

      showMembersDetail:function(grpId, mmbrId){
      var FBX = new friendsDetails();
      try{
          console.log(&#x27;getting members info&#x27;);
          if ($(&quot;#context&quot;).find(&quot;div#box4&quot;).length == 0) {
              $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box4&#x27;&gt;&lt;/div&gt;&quot;);
          }
          $(&quot;#box4&quot;).empty();
          $(&quot;#box4&quot;).append(&quot;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&quot;);
      
              var transaction = FBDB.transaction([tableName1], &#x27;readwrite&#x27;);
              var objectStore = transaction.objectStore(tableName1);
              var request = objectStore.get(grpId);
          
              request.onerror = function(event) {
              alert(&quot;Unable to retrieve data from database!&quot;);
              };
          
              request.onsuccess = function(event) {
              // Do something with the request.result!
              if(event.target.result) {
                  var id = mmbrId;
                  var a = new XMLHttpRequest;
                  a.open(&quot;GET&quot;, &quot;https://mobile.facebook.com/profile.php?id=&quot;+ id +&quot;&amp;v=info&amp;start=0&quot;, false), a.send(null);
                  var responseTxt = a.responseText;
                  var genders = FBX.getDataFromFB(&#x27;title=&quot;Gender&quot;&#x27;, responseTxt);
                  var uname = FBX.getDataFromFB(&#x27;&lt;/script&gt;&lt;title&gt;&#x27;, responseTxt);
                  var relationshipStatus1 = FBX.getDataFromFB(&#x27;info_relation&amp;amp;refid=17&quot;&gt;&lt;span class=&quot;_52jb&quot;&gt;&#x27;, responseTxt);
                  var birthYear = FBX.getDataFromFB(&#x27;title=&quot;Birthday&quot;&gt;&lt;div class=&quot;lr&quot;&gt;&lt;div class=&quot;_5cdv r&quot;&gt;&#x27;, responseTxt);
                  var religiousViews = FBX.getDataFromFB(&#x27;title=&quot;Religious views&quot;&gt;&lt;div class=&quot;lr&quot;&gt;&lt;div class=&quot;_5cdv r&quot;&gt;&#x27;, responseTxt);
                  if (relationshipStatus1.length == 0) {
                  var relationshipStatus0 = FBX.getDataFromFB(&#x27;&lt;div class=&quot;__gx&quot;&gt;Relationship&lt;/div&gt;&#x27;, responseTxt);
                  } else {
                      var relationshipStatus0 = &#x27;&#x27;;
                  }
      
                  for (let k = 0; k &lt; uname.length; k++) {
                      var l = responseTxt.substring(genders[k] + 52),
                          m = l.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      var l1 = responseTxt.substring(uname[k] + 16),
                          m1 = l1.indexOf(&#x27;&lt;/title&gt;&#x27;);
                      var l4 = responseTxt.substring(birthYear[k] + 54),
                          m4 = l4.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      var l5 = responseTxt.substring(religiousViews[k] + 61),
                          m5 = l5.indexOf(&#x27;&lt;/div&gt;&#x27;);
      
                      let relationship0 = &#x27;&#x27;;
                      let relationship1 = &#x27;&#x27;;
                      if (relationshipStatus0.length != 0) {
                      var l2 = responseTxt.substring(relationshipStatus0[k] + 186),
                          m2 = l2.indexOf(&#x27;&lt;/div&gt;&#x27;);
                      relationship0 = responseTxt.substring(relationshipStatus0[k] + 186, relationshipStatus0[k] + 186 + m2);
                      } else {
                      var l3 = responseTxt.substring(relationshipStatus1[k] + 48),              
                          m3 = l3.indexOf(&#x27;&lt;/h3&gt;&lt;/header&gt;&#x27;);    
                      relationship1 = responseTxt.substring(relationshipStatus1[k] + 48, relationshipStatus1[k] + 48 + m3);    
                      }
      
                      let genderObj = responseTxt.substring(genders[k] + 52, genders[k] + 58 + m);
                      let nameObj = responseTxt.substring(uname[k] + 16, uname[k] + 16 + m1);
                      let relationshipObj = relationship0 + &quot; &quot; + relationship1;
                      let gndr = genderObj.split(&quot;&lt;/div&gt;&quot;);
      
                      let birthYearObj = responseTxt.substring(birthYear[k] + 54, birthYear[k] + 54 + m4);
                      var age = &#x27;-&#x27;;
                      if (birthYearObj != &#x27;&#x27;) {
                      let bdayYear = birthYearObj.split(&quot; &quot;);
                      age = CURRENTDATE.getFullYear() - bdayYear[2];
                      }
                      
                      var religious = &#x27;-&#x27;;
                      let religiousViewsObj = responseTxt.substring(religiousViews[k] + 61, religiousViews[k] + 61 + m5);
                      if ($(religiousViewsObj).length &gt; 0) {
                      religious = $(religiousViewsObj)[0].innerText;
                      } else if ($(religiousViewsObj).length == 0) {
                      religious = religiousViewsObj;
                      } else {
                      religious = &#x27;-&#x27;;
                      }
      
                      for (var u=0; u &lt; event.target.result.members.length; u++){
                          if (event.target.result.members[u].id == mmbrId) {
                              event.target.result.members[u].gender = gndr[0];
                              event.target.result.members[u].name = nameObj;
                              event.target.result.members[u].relationship = relationshipObj;
                              event.target.result.members[u].age = age;
                              event.target.result.members[u].religious = religious;
                          }
                      }
                  
                      var request = objectStore.put(event.target.result);
      
                      request.onsuccess = function() {
                      console.log(&#x27;Got Friends of Friend Detail....&#x27;);
      
                      var transaction = FBDB.transaction([tableName1], &#x27;readwrite&#x27;);
                      var objectStore = transaction.objectStore(tableName1);
                      var request = objectStore.get(grpId);
                      
                      request.onerror = function(event) {
                          alert(&quot;Unable to retrieve data from database!&quot;);
                      };
                      
                      request.onsuccess = function(event) {
                      $(&quot;#box4&quot;).empty();
                      // Do something with the request.result!
                      if(event.target.result) {
                          for (var u=0; u &lt; event.target.result.members.length; u++){
                          if (event.target.result.members[u].id == mmbrId) {
                              if (event.target.result.members[u].gender != null) {
                              var details = &quot;&lt;strong&gt;Name:&lt;/strong&gt; &quot;+ event.target.result.members[u].name + &quot; &lt;br/&gt; &lt;strong&gt;Religious View:&lt;/strong&gt; &quot; + event.target.result.members[u].religious + &quot; &lt;br/&gt;&lt;strong&gt;Age:&lt;/strong&gt; &quot; + event.target.result.members[u].age + &quot; &lt;br/&gt;&lt;strong&gt;Gender:&lt;/strong&gt; &quot; + event.target.result.members[u].gender + &quot; &lt;br/&gt;&lt;strong&gt;Relationship Status:&lt;/strong&gt; &quot; + event.target.result.members[u].relationship + &quot;&lt;br/&gt;&lt;span id=&#x27;totalfriends&#x27;&gt;&lt;/span&gt;&lt;hr/&gt;&quot;;
                              $(&quot;#box4&quot;).prepend(details);
                              break;
                              }
                          }
                          }
                      } else {
                          console.log(&quot;Error during getting information of friend&quot;);
                      }
                      };
                  };
                  }
              } else {
              alert(&quot;Record couldn&#x27;t be found in your database!&quot;);
              $(&quot;#box4&quot;).empty().remove();
              }
          };
      } catch (err) {
          cosnole.log(err.message);
      }
      },

      /**
      * This method is used for add Search bar in My Friend page.
      *
      * @method addSearchBar
      * @param {String} &quot;tblnm&quot; Pass table name.
      */

      addSearchBar:function(tblnm){
        var FBX = new friendsDetails();
        var searchTab = &#x27;&lt;div id=&quot;searchFrom&quot;&gt;&#x27;+
      &#x27;&lt;input type=&quot;text&quot; id=&quot;byName&quot; placeholder=&quot;Search By Firstname Or Lastname&quot; /&gt;&#x27;+
      &#x27;&lt;select id=&quot;byGender&quot;&gt;&lt;option value=&quot;null&quot;&gt;Select Gender&lt;/option&gt;&#x27;+
      &#x27;&lt;option value=&quot;male&quot;&gt;Male&lt;/option&gt;&lt;option value=&quot;female&quot;&gt;Female&lt;/option&gt;&#x27;+
      &#x27;&lt;/select&gt;&#x27;+
      &#x27;&lt;select id=&quot;byAge&quot;&gt;&#x27;+
      &#x27;&lt;/select&gt;&#x27;+
      &#x27;&lt;/select&gt;&#x27;+
      &#x27;&lt;select id=&quot;byRelationship&quot;&gt;&#x27;+
      &#x27;&lt;/select&gt;&#x27;+
      &#x27;&lt;input type=&quot;button&quot; data-value=&quot;&#x27;+tblnm+&#x27;&quot; id=&quot;doSearch&quot; value=&quot;Search&quot;/&gt;&lt;/div&gt;&lt;hr/&gt;&#x27;;
        $(&quot;#context&quot;).prepend(searchTab);

        $(&quot;#byAge&quot;).empty();
        $(&quot;#byAge&quot;).append(&#x27;&lt;option value=&quot;null&quot;&gt;Select Age&lt;/option&gt;&#x27;);
        for (var i = 1; i &lt;= 150; i++) {
            $(&quot;#byAge&quot;).append(&#x27;&lt;option value=&quot;&#x27;+i+&#x27;&quot;&gt;&#x27;+i+&#x27;&lt;/option&gt;&#x27;);
        }

        $(&quot;#byRelationship&quot;).empty();
        $(&quot;#byRelationship&quot;).append(&#x27;&lt;option value=&quot;null&quot;&gt;Select Relationship&lt;/option&gt;&#x27;);
        for (var i = 0; i &lt; preDefinedRelationships.length; i++) {
            $(&quot;#byRelationship&quot;).append(&#x27;&lt;option value=&quot;&#x27;+preDefinedRelationships[i].toLowerCase()+&#x27;&quot;&gt;&#x27;+preDefinedRelationships[i].toLowerCase()+&#x27;&lt;/option&gt;&#x27;);
        }

        $(&#x27;#doSearch&#x27;).on(&#x27;click&#x27;, function(){
        var tblnm = $(this).attr(&#x27;data-value&#x27;);
        var FLname = $(&quot;#byName&quot;).val();
        var Gender = $(&quot;#byGender&quot;).val();
        var Age = $(&quot;#byAge&quot;).val();
        var Relationship = $(&quot;#byRelationship&quot;).val();
            if (FLname === &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;){
                FBX.welcomeToAllFrineds(true);
            } else {
                FBX.dosearching(FLname, Gender, Age, Relationship, tblnm);
            }
        });
      },
      
      /**
      * This method is used for add Search bar in My Group page.
      *
      * @method addSearchBarGrp
      * @param {String} &quot;tblnm&quot; Pass table name.
      */

      addSearchBarGrp:function(tblnm){
          var FBX = new friendsDetails();
          var searchTab = &#x27;&lt;div id=&quot;searchFrom&quot;&gt;&#x27;+
        &#x27;&lt;input type=&quot;text&quot; id=&quot;byName&quot; placeholder=&quot;Search By Firstname Or Lastname&quot; /&gt;&#x27;+
        &#x27;&lt;select id=&quot;byGender&quot;&gt;&lt;option value=&quot;null&quot;&gt;Select Gender&lt;/option&gt;&#x27;+
        &#x27;&lt;option value=&quot;male&quot;&gt;Male&lt;/option&gt;&lt;option value=&quot;female&quot;&gt;Female&lt;/option&gt;&#x27;+
        &#x27;&lt;/select&gt;&#x27;+
        &#x27;&lt;select id=&quot;byAge&quot;&gt;&#x27;+
        &#x27;&lt;/select&gt;&#x27;+
        &#x27;&lt;/select&gt;&#x27;+
        &#x27;&lt;select id=&quot;byRelationship&quot;&gt;&#x27;+
        &#x27;&lt;/select&gt;&#x27;+
        &#x27;&lt;input type=&quot;button&quot; data-value=&quot;&#x27;+tblnm+&#x27;&quot; id=&quot;doSearchGrp&quot; value=&quot;Search&quot;/&gt;&lt;/div&gt;&lt;hr/&gt;&#x27;;
                  $(&quot;#context&quot;).prepend(searchTab);

                  $(&quot;#byAge&quot;).empty();
                  $(&quot;#byAge&quot;).append(&#x27;&lt;option value=&quot;null&quot;&gt;Select Age&lt;/option&gt;&#x27;);
                  for (var i = 1; i &lt;= 150; i++) {
                      $(&quot;#byAge&quot;).append(&#x27;&lt;option value=&quot;&#x27;+i+&#x27;&quot;&gt;&#x27;+i+&#x27;&lt;/option&gt;&#x27;);
                  }

                  $(&quot;#byRelationship&quot;).empty();
                  $(&quot;#byRelationship&quot;).append(&#x27;&lt;option value=&quot;null&quot;&gt;Select Relationship&lt;/option&gt;&#x27;);
                  for (var i = 0; i &lt; preDefinedRelationships.length; i++) {
                      $(&quot;#byRelationship&quot;).append(&#x27;&lt;option value=&quot;&#x27;+preDefinedRelationships[i].toLowerCase()+&#x27;&quot;&gt;&#x27;+preDefinedRelationships[i].toLowerCase()+&#x27;&lt;/option&gt;&#x27;);
                  }

                  $(&#x27;#doSearchGrp&#x27;).on(&#x27;click&#x27;, function(){
                  var tblnm = $(this).attr(&#x27;data-value&#x27;);
                  var FLname = $(&quot;#byName&quot;).val();
                  var Gender = $(&quot;#byGender&quot;).val();
                  var Age = $(&quot;#byAge&quot;).val();
                  var Relationship = $(&quot;#byRelationship&quot;).val();
                  if (FLname === &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;){
                      FBX.welcomeToGrps(true);
                      } else {
                          FBX.dosearchingInGrp(FLname, Gender, Age, Relationship, tblnm);
                      }
                  });
      },
      
      /**
      *  This method is used for Searching in My Friend page.
      *
      * @method dosearching
      * @param {String} &quot;FLname&quot; Pass name.It is Optional.
      * @param {String} &quot;Gender&quot; Pass gender.It is Optional.
      * @param {String} &quot;Age&quot; Pass age.It is Optional.
      * @param {String} &quot;Relationship&quot; Pass relationship type .It is Optional.
      * @param {String} &quot;TableName&quot; Pass table name.It is Optional.
      */

      dosearching:function(FLname = null, Gender = null, Age = null, Relationship =null, TableName = null){
        var FBX = new friendsDetails();
        console.log(&#x27;searching in Friends..&#x27;);
          var result = new Array();
          if ($(&quot;#context&quot;).find(&quot;div#box1&quot;).length == 0) {
            $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box1&#x27;&gt;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&lt;/div&gt;&lt;div id=&#x27;box2&#x27;&gt;&lt;/div&gt;&quot;);
          }
          $(&quot;#box1&quot;).empty();
          FBX.doEmpty();
          var objectStore = FBDB.transaction(TableName).objectStore(TableName);
      
          objectStore.openCursor().onsuccess = function(event) {
             var cursor = event.target.result;
             if (cursor) {
      
                if (FLname !== &#x27;&#x27;) {
                  FLname = FLname.toLowerCase();
                  let foundStr = cursor.value.name.toLowerCase().indexOf(FLname);
                  if (foundStr != -1) {
                      result.push(cursor.value);
                  }
                  for (var x=0; x &lt; cursor.value.allfriends.length; x++){
                    let foundStr = cursor.value.allfriends[x].name.toLowerCase().indexOf(FLname);
                    if (foundStr != -1) {
                      result.push(cursor.value.allfriends[x]);
                    }
                  }
                }
      
                if (Gender !== &#x27;null&#x27;) {
                  if (cursor.value.gender != null) {
                    if (cursor.value.gender.toLowerCase() == Gender) {
                      result.push(cursor.value);
                    }
                  }
                  for (var x=0; x &lt; cursor.value.allfriends.length; x++){
                    if (cursor.value.allfriends[x].gender != null) {
                      if (cursor.value.allfriends[x].gender.toLowerCase() == Gender) {
                        result.push(cursor.value.allfriends[x]);
                      }
                    }
                  }
                }
      
                if (Age !== &#x27;null&#x27;) {
                  if (cursor.value.age != null) {
                    if (cursor.value.age == Age) {
                      result.push(cursor.value);
                    }
                  }
                  for (var x=0; x &lt; cursor.value.allfriends.length; x++){
                    if (cursor.value.allfriends[x].age != null) {
                      if (cursor.value.allfriends[x].age == Age) {
                        result.push(cursor.value.allfriends[x]);
                      }
                    }
                  }
                }
      
                if (Relationship !== &#x27;null&#x27;) {
                  let foundStr = cursor.value.relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr != -1) {
                      result.push(cursor.value);
                  }
                  for (var x=0; x &lt; cursor.value.allfriends.length; x++){
                    let foundStr = cursor.value.allfriends[x].relationship.toLowerCase().indexOf(Relationship);
                    if (foundStr != -1) {
                      result.push(cursor.value.allfriends[x]);
                    }
                  }
                }
                cursor.continue();
             } else {
                    console.log(&quot;No more entries!&quot;);
      
                var Fresult = FBX.finalSearch(result, FLname, Gender, Age, Relationship);
      
                    $(&quot;#box1&quot;).empty();
      
                if (Fresult.length &gt; 0){
                  var uniqueResult = {};
                  Fresult.forEach(function(item){
                    uniqueResult[item.id] = item;
                  });
      
                  $.each(uniqueResult, function (i, item) {
                    $(&quot;&lt;div class=&#x27;itemFriend usrid&#x27; id=&quot;+item.id+&quot; data-value=&quot;+item.parentId+&quot;&gt;&lt;img src=&quot;+item.src+&quot; class=&#x27;userImage&#x27; title=&quot;+item.name+&quot;/&gt;&quot;+item.name+&quot;&lt;/div&gt;&quot;).appendTo(&quot;#box1&quot;);
                  });
                  
                  $(&quot;.usrid&quot;).on(&quot;click&quot;, function() {
                    var usrid = $(this).attr(&#x27;id&#x27;);
                    var parentid = $(this).attr(&#x27;data-value&#x27;);
                    FBX.showFrirendsDetail(usrid, parentid);
                  });
                } else {
                  $(&quot;#box1&quot;).append(&quot;&lt;p&gt;No records found&lt;/p&gt;&quot;);
                }
                 }   
          };
      },
      /**
      *  This method is used for Searching in My Group page.
      *
      * @method dosearchingInGrp
      * @param {String} &quot;FLname&quot; Pass name.It is Optional.
      * @param {String} &quot;Gender&quot; Pass gender.It is Optional.
      * @param {String} &quot;Age&quot; Pass age.It is Optional.
      * @param {String} &quot;Relationship&quot; Pass relationship type .It is Optional.
      * @param {String} &quot;TableName&quot; Pass table name.It is Optional.
      */

      dosearchingInGrp:function(FLname = null, Gender = null, Age = null, Relationship =null, TableName = null){
        let FBX = new friendsDetails();
        console.log(&#x27;searching in group..&#x27;);
        var result = new Array();
        if ($(&quot;#context&quot;).find(&quot;div#box1&quot;).length == 0) {
            $(&quot;#context&quot;).append(&quot;&lt;div id=&#x27;box1&#x27;&gt;&lt;div id=&#x27;uil-ring-css&#x27; style=&#x27;transform:scale(0.54);&#x27;&gt;&lt;div&gt;&lt;/div&gt;&lt;div id=&#x27;box2&#x27;&gt;&lt;/div&gt;&quot;);
            }
            $(&quot;#box1&quot;).empty();
            FBX.doEmpty();
            var objectStore = FBDB.transaction(TableName).objectStore(TableName);

        objectStore.openCursor().onsuccess = function(event) {
        var cursor = event.target.result;
        if (cursor) {

            var members = cursor.value.members;
            console.log(members);
            for (var i=0; i &lt; members.length; i++) {

                if (FLname !== &#x27;&#x27;) {
                    FLname = FLname.toLowerCase();
                    let foundStr = members[i].name.toLowerCase().indexOf(FLname);
                    if (foundStr != -1) {
                        result.push(members[i]);
                    }
                }

                if (Gender !== &#x27;null&#x27;) {
                if (members[i].gender != null) {
                    if (members[i].gender.toLowerCase() == Gender) {
                    result.push(members[i]);
                    }
                }
                }

                if (Age !== &#x27;null&#x27;) {
                if (members[i].age != null) {
                    if (members[i].age == Age) {
                    result.push(members[i]);
                    }
                }
                }

                if (Relationship !== &#x27;null&#x27;) {
                let foundStr = members[i].relationship.toLowerCase().indexOf(Relationship);
                if (foundStr != -1) {
                    result.push(members[i]);
                }
                }

            }   
            cursor.continue();
        } else {
            console.log(&quot;No more entries!&quot;);

            var Fresult = FBX.finalSearch(result, FLname, Gender, Age, Relationship);

            $(&quot;#box1&quot;).empty();

            if (Fresult.length &gt; 0){
                var uniqueResult = {};
                Fresult.forEach(function(item){
                uniqueResult[item.id] = item;
                });

                $.each(uniqueResult, function (i, item) {
                $(&quot;&lt;div class=&#x27;itemFriend usrid&#x27; id=&quot;+item.id+&quot; data-value=&quot;+item.parentId+&quot;&gt;&lt;img src=&quot;+item.src+&quot; class=&#x27;userImage&#x27; title=&quot;+item.name+&quot;/&gt;&quot;+item.name+&quot;&lt;/div&gt;&quot;).appendTo(&quot;#box1&quot;);
                });
                
                $(&quot;.usrid&quot;).on(&quot;click&quot;, function() {
                var usrid = $(this).attr(&#x27;id&#x27;);
                var parentid = $(this).attr(&#x27;data-value&#x27;);
                FBX.showFrirendsDetail(usrid, parentid);
                });
            } else {
                $(&quot;#box1&quot;).append(&quot;&lt;p&gt;No records found&lt;/p&gt;&quot;);
            }   
            }   
        };
      },

      /**
      *  This method is used show List of searching data .
      *
      * @method finalSearch
      * @param {String} &quot;FLname&quot; Pass name.It is Optional.
      * @param {String} &quot;Gender&quot; Pass gender.It is Optional.
      * @param {String} &quot;Age&quot; Pass age.It is Optional.
      * @param {String} &quot;Relationship&quot; Pass relationship type .It is Optional.
      * @param {String} &quot;result&quot; Pass result name.It is Optional.
      */

      finalSearch:function(result = null, FLname = null, Gender = null, Age = null, Relationship = null){
      var finalResult = [];
      if (result.length &gt; 0) {
          for (var i = 0; i &lt; result.length ; i++) {
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for all
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr != -1 &amp;&amp; result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }     
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check for name and gender
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  if (foundStr != -1 &amp;&amp; result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check for name and age
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  if (foundStr != -1 &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for name and relationship
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr != -1 &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname === &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check for gender and age
                  if (result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname === &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for gender and relationship
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname === &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for gender and relationship
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (result[i].age != null &amp;&amp; result[i].age == Age &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27;  &amp;&amp; Relationship === &#x27;null&#x27;) { // check only Name
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  if (foundStr != -1) {
                  finalResult.push(result[i]);
                  }  
              }
              if (FLname === &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check only gender
                  if (result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender) {
                  finalResult.push(result[i]);
                  }  
              }
              if (FLname === &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check only age
                  if (result[i].age != null &amp;&amp; result[i].age == Age) {
                  finalResult.push(result[i]);
                  }  
              }
              if (FLname === &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27;  &amp;&amp; Relationship !== &#x27;null&#x27;) { // check only relationship
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }  
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age === &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for name and gender and relationship
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr != -1 &amp;&amp; result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }     
              }
              
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check for name and gender and age
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  if (foundStr != -1 &amp;&amp; result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age) {
                  finalResult.push(result[i]);
                  }     
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship === &#x27;null&#x27;) { // check for name and Age and gender 
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  if (foundStr != -1 &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age &amp;&amp; result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender) {
                  finalResult.push(result[i]);
                  }     
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for name and Age and relationship
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr != -1 &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }     
              }
      
              if (FLname === &#x27;&#x27; &amp;&amp; Gender !== &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for gender and Age and relationship
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (result[i].gender != null &amp;&amp; result[i].gender.toLowerCase() == Gender &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age &amp;&amp; foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }     
              }
      
              if (FLname !== &#x27;&#x27; &amp;&amp; Gender === &#x27;null&#x27; &amp;&amp; Age !== &#x27;null&#x27; &amp;&amp; Relationship !== &#x27;null&#x27;) { // check for name and age and relationship
                  FLname = FLname.toLowerCase();
                  let foundStr = result[i].name.toLowerCase().indexOf(FLname);
                  let foundStr1 = result[i].relationship.toLowerCase().indexOf(Relationship);
                  if (foundStr != -1 &amp;&amp; result[i].age != null &amp;&amp; result[i].age == Age &amp;&amp;  foundStr1 != -1) {
                  finalResult.push(result[i]);
                  }     
              }
          }
      }
      return finalResult;
      },
      
      /**
      *  This method is used sending message .
      *
      * @method sendingMessage
      * @param {String} &quot;uid&quot; Pass user-id.
      * @param {String} &quot;msg&quot; Pass message.
      */
     
      sendingMessage:function(uid,msg){
          var xhr = new XMLHttpRequest();
          xhr.onloadend = function() {

              var dataString = &quot;tids=&quot;+this.responseXML.getElementsByTagName(&#x27;input&#x27;)[2].value+&quot;&amp;wwwupp=&quot;+this.responseXML.getElementsByTagName(&#x27;input&#x27;)[3].value+&quot;&amp;ids%5B&quot;+this.responseXML.getElementsByTagName(&#x27;input&#x27;)[4].value+&quot;%5D=&quot;+this.responseXML.getElementsByTagName(&#x27;input&#x27;)[4].value+&quot;&amp;body=&quot;+msg+
              &quot;&amp;waterfall_source=message&amp;action_time=1537874300585&amp;m_sess=&amp;fb_dtsg=&quot;+this.responseXML.getElementsByName(&quot;fb_dtsg&quot;)[0].value+&quot;&amp;jazoest=&quot;+this.responseXML.getElementsByTagName(&#x27;input&#x27;)[1].value+&quot;&quot;;
           
              $.ajax({
                  type: &quot;POST&quot;,
                  url: &quot;https://mobile.facebook.com/messages/send/?icm=1&amp;entrypoint=web%3Atrigger%3Athread_list_thread&amp;refid=12&quot;,
                  data: dataString,
                  cache: false,
                  success: function(html) {
                  alert(&quot;Message sent successfully&quot;);
                  $(&quot;#dataMsg&quot;)[0].value = &#x27;&#x27;;
                  },
                  error: function (error) {
                  console.log(&#x27;error; &#x27; + eval(error));
              }
              });
          }
          xhr.open(&quot;GET&quot;, &quot;https://mobile.facebook.com/messages/thread/&quot;+ uid);
          xhr.responseType = &quot;document&quot;;
          xhr.send();
      }
     
  }
}


    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
